---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

library(biomuts)
```

# biomuts

<!-- badges: start -->
<!-- badges: end -->


## installation

You can install the development version of `biomuts` like so:

``` r
devtools::install_github("william-swl/biomuts")
```

## S4 classes

### BiologySeq
- a S4 class to operate DNA together with AA sequence

```{r S4-BiologySeq}
bs <- BiologySeq("ATGAAA---CCCTTTGGG---")

DNA(bs)

AA(bs)

DNA(bs) <- "ATGAAACCCTTTGGG"

bs

DNA(bs)[1:6] <- "A"

bs

# get DNA site by AA site
DNAsite_by_AA(bs, start = 2, end = 3)

# get AA site by DNA site
AAsite_by_DNA(bs, start = 1, end = 9)
```


### BiologySeqSet
- a S4 class to operate DNA together with AA sequence set

```{r S4-BiologySeqSet}
bss <- BiologySeqSet(c("ATGAAA---", "ATG---AAA"))

DNA(bss)

AA(bss)

DNA(bss) <- c("ATGAAACCC", "ATGCCCAAA")

bss

# get DNA site by AA site
DNAsite_by_AA(bss, start = 2, end = 3)

# get AA site by DNA site
AAsite_by_DNA(bss, start = 3, end = 9)
```

### BiologySeqMSA
- a S4 class to operate aligned DNA together with AA sequence set
```{r S4-BiologySeqMSA}
bss <- BiologySeqSet(
  c("ATGCAGGTAAACCCTACTGAG", "ATGCAGGTTACTGAG", "ATGCAGGTAACTGTG")
)
alnbs <- BiologySeqMSA(bss)

alnbs

consDNA(alnbs)

consDNAfreq(alnbs)

consAA(alnbs)

consAAfreq(alnbs)
```

## utils
- correct the gaps location to fit codon frames
```{r utils-DNA_gaps_corr}
DNA_gaps_corr("AT---G")
```

- translate DNA to AA (gaps allowed)
```{r utils-dna2aa}
dna2aa("ATG---AAA")
```
